{"version":3,"sources":["broccoli/broccoli-dest-copy.ts"],"names":["DestCopy","DestCopy.constructor","DestCopy.rebuild"],"mappings":"AAAA,kDAAkD;AAClD,0DAA0D;AAE1D,IAAO,EAAE,WAAW,IAAI,CAAC,CAAC;AAC1B,IAAO,GAAG,WAAW,UAAU,CAAC,CAAC;AACjC,IAAO,IAAI,WAAW,MAAM,CAAC,CAAC;AAC9B,wCAAmE,2BAA2B,CAAC,CAAA;AAE/F;;;GAGG;AACH;IACEA,kBAAoBA,SAASA,EAAUA,SAASA,EAAUA,UAAkBA;QAAxDC,cAASA,GAATA,SAASA,CAAAA;QAAUA,cAASA,GAATA,SAASA,CAAAA;QAAUA,eAAUA,GAAVA,UAAUA,CAAQA;IAAGA,CAACA;IAGhFD,0BAAOA,GAAPA,UAAQA,QAAoBA;QAA5BE,iBAgBCA;QAfCA,QAAQA,CAACA,UAAUA,CAACA,MAAMA,CAACA,QAAQA,CAACA,YAAYA,CAACA;aAC5CA,OAAOA,CAACA,UAACA,eAAeA;YACvBA,IAAIA,YAAYA,GAAGA,IAAIA,CAACA,IAAIA,CAACA,KAAIA,CAACA,UAAUA,EAAEA,eAAeA,CAACA,CAACA;YAE/DA,IAAIA,WAAWA,GAAGA,IAAIA,CAACA,OAAOA,CAACA,YAAYA,CAACA,CAACA;YAC7CA,GAAGA,CAACA,UAAUA,CAACA,WAAWA,CAACA,CAACA;YAC5BA,GAAGA,CAACA,QAAQA,CAACA,IAAIA,CAACA,IAAIA,CAACA,KAAIA,CAACA,SAASA,EAAEA,eAAeA,CAACA,EAAEA,YAAYA,CAACA,CAACA;QACzEA,CAACA,CAACA,CAACA;QAEPA,QAAQA,CAACA,YAAYA,CAACA,OAAOA,CAACA,UAACA,eAAeA;YAC5CA,IAAIA,YAAYA,GAAGA,IAAIA,CAACA,IAAIA,CAACA,KAAIA,CAACA,UAAUA,EAAEA,eAAeA,CAACA,CAACA;YAE/DA,0EAA0EA;YAC1EA,EAAEA,CAACA,UAAUA,CAACA,YAAYA,CAACA,CAACA;QAC9BA,CAACA,CAACA,CAACA;IACLA,CAACA;IACHF,eAACA;AAADA,CArBA,AAqBCA,IAAA;AAED;kBAAe,2CAAiB,CAAC,QAAQ,CAAC,CAAC","file":"broccoli/broccoli-dest-copy.js","sourcesContent":["/// <reference path=\"../typings/node/node.d.ts\" />\n/// <reference path=\"../typings/fs-extra/fs-extra.d.ts\" />\n\nimport fs = require('fs');\nimport fse = require('fs-extra');\nimport path = require('path');\nimport {wrapDiffingPlugin, DiffingBroccoliPlugin, DiffResult} from './diffing-broccoli-plugin';\n\n/**\n * Intercepts each file as it is copied to the destination tempdir,\n * and tees a copy to the given path outside the tmp dir.\n */\nclass DestCopy implements DiffingBroccoliPlugin {\n  constructor(private inputPath, private cachePath, private outputRoot: string) {}\n\n\n  rebuild(treeDiff: DiffResult) {\n    treeDiff.addedPaths.concat(treeDiff.changedPaths)\n        .forEach((changedFilePath) => {\n          var destFilePath = path.join(this.outputRoot, changedFilePath);\n\n          var destDirPath = path.dirname(destFilePath);\n          fse.mkdirsSync(destDirPath);\n          fse.copySync(path.join(this.inputPath, changedFilePath), destFilePath);\n        });\n\n    treeDiff.removedPaths.forEach((removedFilePath) => {\n      var destFilePath = path.join(this.outputRoot, removedFilePath);\n\n      // TODO: what about obsolete directories? we are not cleaning those up yet\n      fs.unlinkSync(destFilePath);\n    });\n  }\n}\n\nexport default wrapDiffingPlugin(DestCopy);\n"],"sourceRoot":"/source/"}